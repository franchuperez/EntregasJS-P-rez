<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Gracias por tu compra</title>
    <link rel="stylesheet" href="../css/style.css" />
</head>

<body>
<div class="gracias-container">
    <h1>¡Gracias por tu compra!</h1>
    <p>En breves nos comunicamos con usted.</p>
    <a href="../index.html">Volver al inicio</a>
</div>

<section id="resumen" class="gracias-container" aria-live="polite"></section>

<script>
const cliente = JSON.parse(localStorage.getItem("cliente"));
const carrito = JSON.parse(localStorage.getItem("carrito")) || [];

/* resumen de compra y datos del cliente */
function mostrarResumenCompleto() {
    const resumenDiv = document.getElementById("resumen");
    
    if (!cliente) {
        resumenDiv.innerHTML = "<p>No se encontraron datos del cliente.</p>";
        return;
    }
    
    if (carrito.length === 0) {
        resumenDiv.innerHTML = "<p>No hay productos en el carrito.</p>";
        return;
    }

/* calcular el total de la compra */
    const total = carrito.reduce((acc, item) => acc + item.precio * (item.cantidad || 1), 0);
    
/* crear lista de productos para mostrarle al final*/
    const listaProductos = carrito.map(item => `
        <li>${item.nombre} x ${item.cantidad || 1} → $${item.precio * (item.cantidad || 1)}</li>
    `).join("");

    const clienteHtml = `
        <h2>Datos del cliente</h2>
        <p><strong>Nombre:</strong> ${cliente.nombre}</p>
        <p><strong>Edad:</strong> ${cliente.edad}</p>
        <p><strong>Email:</strong> ${cliente.email}</p>
        <p><strong>Teléfono:</strong> ${cliente.telefono}</p>
        <p><strong>Método de pago:</strong> ${cliente.metodoPago}</p>
        <p><strong>Contacto preferido:</strong> ${cliente.contacto}</p>
    `;

/* mostrar los dos resumenes */
    resumenDiv.innerHTML = `
        <div class="resumen-dos-columnas">
            <div class="columna-cliente">
                ${clienteHtml}
            </div>
            <div class="columna-compra">
                <h2>Resumen de compra</h2>
                <ul style="text-align:left; display:inline-block">${listaProductos}</ul>
                <p><strong>Total: ${total}</strong></p>
            </div>
        </div>
    `;
}
/* mensaje de gracias */
if (cliente && carrito.length > 0) {
    const total = carrito.reduce((acc, i) => acc + i.precio * (i.cantidad || 1), 0);
}

mostrarResumenCompleto();

/* para reiniciar el carrito al finalizar la compra*/
localStorage.removeItem("carrito");
</script>

</body>
</html>